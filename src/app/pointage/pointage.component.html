<div class="pointage-container">
  <h2>Gestion du Pointage</h2>

  <div class="current-time">
    <p>Date et Heure Actuelles : <strong>{{ currentDateTime | date:'fullDate' }} {{ currentDateTime | date:'HH:mm:ss' }}</strong></p>
  </div>

  <div class="form-section">
    <h3>Enregistrer un Pointage</h3>
    <div class="input-group">
      <label for="personnelId">ID Personnel :</label>
      <input type="text" id="personnelId" [(ngModel)]="personnelId" placeholder="Ex: DTS-DIAMNSall-Pharmacie-001" (keyup.enter)="processBarcode()">
    </div>
    <div class="input-group">
      <label for="selectedDate">Date du Pointage :</label>
      <input type="date" id="selectedDate" [(ngModel)]="selectedDate">
    </div>

    <div class="buttons-group">
      <button class="btn-auto" (click)="processBarcode()">Pointer Automatique</button>
      <button class="btn-arrivee" (click)="pointerArrivee()">Pointer Arrivée</button>
      <button class="btn-depart" (click)="pointerDepart()">Pointer Départ</button>
    </div>
  </div>

  <hr>

  <div class="calculation-section">
    <h3>Calcul des Heures Mensuelles</h3>
    <div class="input-group">
      <label for="monthlyPersonnelId">ID Personnel :</label>
      <input type="text" id="monthlyPersonnelId" [(ngModel)]="monthlyPersonnelId" placeholder="ID Personnel">
    </div>
    <div class="input-group">
      <label for="selectedMonth">Mois :</label>
      <!-- Correction ici pour afficher les noms des mois -->
      <select id="selectedMonth" [(ngModel)]="selectedMonth">
        <option value="1">Janvier</option>
        <option value="2">Février</option>
        <option value="3">Mars</option>
        <option value="4">Avril</option>
        <option value="5">Mai</option>
        <option value="6">Juin</option>
        <option value="7">Juillet</option>
        <option value="8">Août</option>
        <option value="9">Septembre</option>
        <option value="10">Octobre</option>
        <option value="11">Novembre</option>
        <option value="12">Décembre</option>
      </select>
      <label for="selectedYear">Année :</label>
      <input type="number" id="selectedYear" [(ngModel)]="selectedYear" min="2000" max="2100">
    </div>
    <button class="btn-calculate" (click)="calculateMonthlyWorkHours()">Calculer</button>
    <div class="result-box">
      <p>Heures de travail pour le mois : <strong>{{monthlyWorkHours}}</strong></p>
    </div>
  </div>

  <hr>

  <div class="list-section">
    <h3>Pointages Récents</h3>
    <div *ngIf="timeEntries.length === 0" class="no-data-message">
      <p>Aucun pointage enregistré pour le moment.</p>
    </div>

    <table *ngIf="timeEntries.length > 0">
      <thead>
      <tr>
        <th>ID Personnel</th>
        <th>Date</th>
        <th>Heure d'Arrivée</th>
        <th>Heure de Départ</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let entry of timeEntries">
        <td>{{ entry.personnel_id }}</td>
        <td>{{ entry.date }}</td>
        <td>{{ formatTime(entry.heure_arrivee) }}</td>
        <td>{{ formatTime(entry.heure_depart) }}</td>
        <td>
          <button class="btn-delete" (click)="deletePointage(entry.id)">Supprimer</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
